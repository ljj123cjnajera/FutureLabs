<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administración - FutureLabs</title>
    
    <!-- Google Fonts - Fuentes Profesionales -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/design-system.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/notifications.css">
    <link rel="stylesheet" href="css/modals-improved.css">
    <link rel="stylesheet" href="css/forms-improved.css">
    <link rel="stylesheet" href="css/micro-interactions.css">
    <link rel="stylesheet" href="css/loading-states-improved.css">
    <!-- Estilos inline removidos - migrados a admin.css -->
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>FutureLabs</h1>
                <p>Panel de Administración</p>
            </div>
            
            <div class="sidebar-menu">
                <div class="menu-item active" data-section="dashboard">
                    <i class="fas fa-chart-line"></i>
                    <span>Dashboard</span>
                </div>
                <div class="menu-item" data-section="products">
                    <i class="fas fa-box"></i>
                    <span>Productos</span>
                </div>
                <div class="menu-item" data-section="categories">
                    <i class="fas fa-tags"></i>
                    <span>Categorías</span>
                </div>
                <div class="menu-item" data-section="orders">
                    <i class="fas fa-shopping-bag"></i>
                    <span>Pedidos</span>
                </div>
                <div class="menu-item" data-section="payments">
                    <i class="fas fa-credit-card"></i>
                    <span>Pagos</span>
                </div>
                <div class="menu-item" data-section="users">
                    <i class="fas fa-users"></i>
                    <span>Usuarios</span>
                </div>
                <div class="menu-item" data-section="reviews">
                    <i class="fas fa-star"></i>
                    <span>Reseñas</span>
                </div>
                <div class="menu-item" data-section="reports">
                    <i class="fas fa-file-alt"></i>
                    <span>Reportes</span>
                </div>
                <div class="menu-item" data-section="hero-slides" style="border-top: 1px solid rgba(255,255,255,0.1); margin-top: 10px; padding-top: 20px;">
                    <i class="fas fa-sliders-h"></i>
                    <span>Hero Slides</span>
                </div>
                <div class="menu-item" data-section="banners">
                    <i class="fas fa-image"></i>
                    <span>Banners</span>
                </div>
                <div class="menu-item" data-section="benefits">
                    <i class="fas fa-gift"></i>
                    <span>Beneficios</span>
                </div>
                <div class="menu-item" data-section="home-sections">
                    <i class="fas fa-th-large"></i>
                    <span>Secciones Home</span>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <div class="admin-header">
                <h2 id="pageTitle">Dashboard</h2>
                <div class="admin-header-actions">
                    <div class="user-info">
                        <div class="user-avatar" id="userAvatar">A</div>
                        <div>
                            <div style="font-weight: 600;" id="userName">Admin</div>
                            <div style="font-size: 12px; color: #999;" id="userRole">Administrador</div>
                        </div>
                    </div>
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Salir
                    </button>
                </div>
            </div>
            
            <div class="content-area">
                <!-- Dashboard Section -->
                <div class="section active" id="dashboard">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-title">Total Productos</div>
                                <div class="stat-card-icon" style="background: #e3f2fd; color: #2196f3;">
                                    <i class="fas fa-box"></i>
                                </div>
                            </div>
                            <div class="stat-card-value" id="totalProducts">0</div>
                            <div class="stat-card-change">+12% este mes</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-title">Total Usuarios</div>
                                <div class="stat-card-icon" style="background: #f3e5f5; color: #9c27b0;">
                                    <i class="fas fa-users"></i>
                                </div>
                            </div>
                            <div class="stat-card-value" id="totalUsers">0</div>
                            <div class="stat-card-change">+8% este mes</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-title">Total Pedidos</div>
                                <div class="stat-card-icon" style="background: #e8f5e9; color: #4caf50;">
                                    <i class="fas fa-shopping-bag"></i>
                                </div>
                            </div>
                            <div class="stat-card-value" id="totalOrders">0</div>
                            <div class="stat-card-change">+15% este mes</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-title">Ventas Totales</div>
                                <div class="stat-card-icon" style="background: #fff3e0; color: #ff9800;">
                                    <i class="fas fa-dollar-sign"></i>
                                </div>
                            </div>
                            <div class="stat-card-value" id="totalSales">S/ 0</div>
                            <div class="stat-card-change">+20% este mes</div>
                        </div>
                    </div>
                    
                    <!-- Gráficos -->
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px; margin-top: 30px;">
                        <!-- Gráfico de Ventas -->
                        <div class="chart-card">
                            <h3>Ventas de los Últimos 7 Días</h3>
                            <canvas id="salesChart"></canvas>
                        </div>
                        
                        <!-- Gráfico de Estados de Pedidos -->
                        <div class="chart-card">
                            <h3>Pedidos por Estado</h3>
                            <canvas id="ordersStatusChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- Segundo row de gráficos -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 30px;">
                        <!-- Top Productos -->
                        <div class="chart-card">
                            <h3>Top 5 Productos Más Vendidos</h3>
                            <canvas id="topProductsChart"></canvas>
                        </div>
                        
                        <!-- Métodos de Pago -->
                        <div class="chart-card">
                            <h3>Métodos de Pago</h3>
                            <canvas id="paymentMethodsChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="table-container" style="margin-top: 30px;">
                        <div class="table-header">
                            <h3>Pedidos Recientes</h3>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Cliente</th>
                                    <th>Total</th>
                                    <th>Estado</th>
                                    <th>Fecha</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="recentOrdersTable">
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 40px;">Cargando...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Products Section -->
                <div class="section" id="products">
                    <div class="table-container">
                        <div class="table-header">
                            <h3>Gestión de Productos</h3>
                            <button class="btn-primary" onclick="openProductModal()">
                                <i class="fas fa-plus"></i> Nuevo Producto
                            </button>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>Categoría</th>
                                    <th>Precio</th>
                                    <th>Stock</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="productsTable">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 40px;">Cargando...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Categories Section -->
                <div class="section" id="categories">
                    <div class="table-container">
                        <div class="table-header">
                            <h3>Gestión de Categorías</h3>
                            <button class="btn-primary" onclick="openCategoryModal()">
                                <i class="fas fa-plus"></i> Nueva Categoría
                            </button>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>Slug</th>
                                    <th>Descripción</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="categoriesTable">
                                <tr>
                                    <td colspan="5" style="text-align: center; padding: 40px;">Cargando...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Orders Section -->
                <div class="section" id="orders">
                    <div class="table-container">
                        <div class="table-header">
                            <h3>Gestión de Pedidos</h3>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Pedido</th>
                                    <th>Cliente</th>
                                    <th>Total</th>
                                    <th>Estado</th>
                                    <th>Pago</th>
                                    <th>Fecha</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="ordersTable">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 40px;">Cargando...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Payments Section -->
                <div class="section" id="payments">
                    <div class="section-header">
                        <h3>Gestión de Pagos</h3>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn-secondary" onclick="window.adminManager?.loadPayments('all')">
                                <i class="fas fa-list"></i> Todas
                            </button>
                            <button class="btn-secondary" onclick="window.adminManager?.loadPayments('pending')">
                                <i class="fas fa-clock"></i> Pendientes
                            </button>
                            <button class="btn-secondary" onclick="window.adminManager?.loadPayments('succeeded')">
                                <i class="fas fa-check-circle"></i> Exitosos
                            </button>
                            <button class="btn-secondary" onclick="window.adminManager?.loadPayments('failed')">
                                <i class="fas fa-times-circle"></i> Fallidos
                            </button>
                        </div>
                    </div>
                    
                    <div class="stats-grid" style="margin-bottom: 20px;">
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-title">Pendientes</div>
                                <div class="stat-card-icon" style="background: #fff3cd; color: #ffc107;">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>
                            <div class="stat-card-value" id="pendingPaymentsCount">0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-title">Monto Pendiente</div>
                                <div class="stat-card-icon" style="background: #e3f2fd; color: #2196f3;">
                                    <i class="fas fa-dollar-sign"></i>
                                </div>
                            </div>
                            <div class="stat-card-value" id="pendingPaymentsAmount">S/ 0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-card-header">
                                <div class="stat-card-title">Total Procesado</div>
                                <div class="stat-card-icon" style="background: #e8f5e9; color: #4caf50;">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                            </div>
                            <div class="stat-card-value" id="totalProcessedAmount">S/ 0</div>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID Transacción</th>
                                    <th>Pedido</th>
                                    <th>Cliente</th>
                                    <th>Método</th>
                                    <th>Monto</th>
                                    <th>Estado</th>
                                    <th>Fecha</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="paymentsTable">
                                <tr>
                                    <td colspan="8" style="text-align: center; padding: 40px;">Cargando...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Users Section -->
                <div class="section" id="users">
                    <div class="table-container">
                        <div class="table-header">
                            <h3>Gestión de Usuarios</h3>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>Email</th>
                                    <th>Rol</th>
                                    <th>Verificado</th>
                                    <th>Fecha</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="usersTable">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 40px;">Cargando...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Reviews Section -->
                <div class="section" id="reviews">
                    <div class="table-container">
                        <div class="table-header">
                            <h3>Gestión de Reseñas</h3>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Usuario</th>
                                    <th>Producto</th>
                                    <th>Rating</th>
                                    <th>Título</th>
                                    <th>Aprobada</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="reviewsTable">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 40px;">Cargando...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Reports Section -->
                <div class="section" id="reports">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px;">
                        <!-- Reporte de Ventas -->
                        <div class="report-card">
                            <div class="report-icon">
                                <i class="fas fa-chart-line" style="color: #667eea;"></i>
                            </div>
                            <h3>Reporte de Ventas</h3>
                            <p>Exporta tus ventas en formato CSV</p>
                            <div class="report-filters">
                                <input type="date" id="salesStartDate" style="margin-bottom: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                                <input type="date" id="salesEndDate" style="margin-bottom: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            </div>
                            <button class="btn-primary" onclick="exportSalesReport()">
                                <i class="fas fa-download"></i> Exportar CSV
                            </button>
                        </div>

                        <!-- Reporte de Productos -->
                        <div class="report-card">
                            <div class="report-icon">
                                <i class="fas fa-box" style="color: #764ba2;"></i>
                            </div>
                            <h3>Reporte de Productos</h3>
                            <p>Lista completa de productos con ventas</p>
                            <button class="btn-primary" onclick="exportProductsReport()">
                                <i class="fas fa-download"></i> Exportar CSV
                            </button>
                        </div>

                        <!-- Reporte de Clientes -->
                        <div class="report-card">
                            <div class="report-icon">
                                <i class="fas fa-users" style="color: #4facfe;"></i>
                            </div>
                            <h3>Reporte de Clientes</h3>
                            <p>Base de datos de clientes y compras</p>
                            <button class="btn-primary" onclick="exportCustomersReport()">
                                <i class="fas fa-download"></i> Exportar JSON
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Hero Slides Section -->
                <div class="section" id="hero-slides">
                    <div class="section-header">
                        <h3>Hero Slides (Carrusel Principal)</h3>
                        <button class="btn-primary" onclick="openHeroSlideModal()">
                            <i class="fas fa-plus"></i> Nuevo Slide
                        </button>
                    </div>
                    <div id="heroSlidesTable"></div>
                </div>

                <!-- Banners Section -->
                <div class="section" id="banners">
                    <div class="section-header">
                        <h3>Banners Promocionales</h3>
                        <button class="btn-primary" onclick="openBannerModal()">
                            <i class="fas fa-plus"></i> Nuevo Banner
                        </button>
                    </div>
                    <div id="bannersTable"></div>
                </div>

                <!-- Benefits Section -->
                <div class="section" id="benefits">
                    <div class="section-header">
                        <h3>Beneficios</h3>
                        <button class="btn-primary" onclick="openBenefitModal()">
                            <i class="fas fa-plus"></i> Nuevo Beneficio
                        </button>
                    </div>
                    <div id="benefitsTable"></div>
                </div>

                <!-- Home Sections Section -->
                <div class="section" id="home-sections">
                    <div class="section-header">
                        <h3>Secciones del Home</h3>
                        <button class="btn-primary" onclick="openHomeSectionModal()">
                            <i class="fas fa-plus"></i> Nueva Sección
                        </button>
                    </div>
                    <div id="homeSectionsTable"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modales -->
    
    <!-- Product Modal -->
    <div id="productModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="productModalTitle">Crear Producto</h3>
                <span class="modal-close">&times;</span>
            </div>
            <form id="productForm">
                <div class="form-group">
                    <label>Nombre *</label>
                    <input type="text" id="productName" required>
                </div>
                <div class="form-group">
                    <label>Slug *</label>
                    <input type="text" id="productSlug" required>
                </div>
                <div class="form-group">
                    <label>Descripción</label>
                    <textarea id="productDescription" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Precio *</label>
                        <input type="number" id="productPrice" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>Precio Descuento</label>
                        <input type="number" id="productDiscountPrice" step="0.01">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Stock *</label>
                        <input type="number" id="productStock" required>
                    </div>
                    <div class="form-group">
                        <label>Categoría *</label>
                        <select id="productCategory" required>
                            <option value="">Seleccionar...</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Marca *</label>
                        <input type="text" id="productBrand" required>
                    </div>
                    <div class="form-group">
                        <label>SKU</label>
                        <input type="text" id="productSKU">
                    </div>
                </div>
                <div class="form-group">
                    <label>Imagen del Producto *</label>
                    <div style="margin-bottom: 10px;">
                        <label class="btn btn-outline" style="display: inline-block; cursor: pointer; padding: 8px 16px; border-radius: 4px; border: 1px solid #ddd;">
                            <i class="fas fa-upload"></i> Subir Imagen
                            <input type="file" id="productImageFile" accept="image/*" style="display: none;" onchange="previewProductImage(this)">
                        </label>
                        <span id="imageFileName" style="margin-left: 10px; color: #666;"></span>
                    </div>
                    
                    <!-- Preview de imagen -->
                    <div id="imagePreviewContainer" style="margin-top: 15px; display: none;">
                        <div style="position: relative; display: inline-block;">
                            <img id="previewImage" src="" alt="Preview" style="max-width: 200px; max-height: 200px; border-radius: 8px; border: 1px solid #ddd;">
                            <button type="button" onclick="clearImagePreview()" style="position: absolute; top: -10px; right: -10px; background: #ef4444; color: white; border: none; border-radius: 50%; width: 24px; height: 24px; cursor: pointer; font-size: 14px;">
                                ×
                            </button>
                        </div>
                    </div>
                    
                    <!-- O usar URL -->
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
                        <label style="font-size: 12px; color: #666;">O ingresa una URL de imagen:</label>
                        <input type="url" id="productImage" placeholder="https://ejemplo.com/imagen.jpg" style="margin-top: 5px;">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Peso (kg)</label>
                        <input type="text" id="productWeight">
                    </div>
                    <div class="form-group">
                        <label>Dimensiones</label>
                        <input type="text" id="productDimensions" placeholder="LxAxA">
                    </div>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="productIsActive" checked> Activo
                    </label>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.adminCRUD?.closeModalById('productModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Category Modal -->
    <div id="categoryModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="categoryModalTitle">Crear Categoría</h3>
                <span class="modal-close">&times;</span>
            </div>
            <form id="categoryForm">
                <div class="form-group">
                    <label>Nombre *</label>
                    <input type="text" id="categoryName" required>
                </div>
                <div class="form-group">
                    <label>Slug *</label>
                    <input type="text" id="categorySlug" required>
                </div>
                <div class="form-group">
                    <label>Descripción</label>
                    <textarea id="categoryDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Imagen URL</label>
                    <input type="url" id="categoryImage">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.adminCRUD?.closeModalById('categoryModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Modal -->
    <div id="userModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="userModalTitle">Editar Usuario</h3>
                <span class="modal-close">&times;</span>
            </div>
            <form id="userForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>Nombre *</label>
                        <input type="text" id="userFirstName" required>
                    </div>
                    <div class="form-group">
                        <label>Apellido *</label>
                        <input type="text" id="userLastName" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" id="userEmail" required>
                </div>
                <div class="form-group">
                    <label>Teléfono</label>
                    <input type="tel" id="userPhone">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Rol *</label>
                        <select id="userRole" required>
                            <option value="client">Cliente</option>
                            <option value="moderator">Moderador</option>
                            <option value="admin">Administrador</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="userEmailVerified"> Email Verificado
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.adminCRUD?.closeModalById('userModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Review Modal -->
    <div id="reviewModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="reviewModalTitle">Editar Reseña</h3>
                <span class="modal-close">&times;</span>
            </div>
            <form id="reviewForm">
                <div class="form-group">
                    <label>Rating *</label>
                    <select id="reviewRating" required>
                        <option value="1">1 estrella</option>
                        <option value="2">2 estrellas</option>
                        <option value="3">3 estrellas</option>
                        <option value="4">4 estrellas</option>
                        <option value="5">5 estrellas</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Título</label>
                    <input type="text" id="reviewTitle">
                </div>
                <div class="form-group">
                    <label>Comentario</label>
                    <textarea id="reviewComment" rows="4"></textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="reviewIsApproved"> Aprobada
                    </label>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.adminCRUD?.closeModalById('reviewModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Order Modal -->
    <div id="orderModal" class="modal modal-large" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Detalles del Pedido</h3>
                <span class="modal-close">&times;</span>
            </div>
            <div id="orderDetails">
                <div class="order-info-section">
                    <h4>Información del Pedido</h4>
                    <div class="info-grid">
                        <div class="info-item">
                            <label>Número de Pedido:</label>
                            <span id="orderDetailsNumber"></span>
                        </div>
                        <div class="info-item">
                            <label>Cliente:</label>
                            <span id="orderDetailsCustomer"></span>
                        </div>
                        <div class="info-item">
                            <label>Email:</label>
                            <span id="orderDetailsEmail"></span>
                        </div>
                        <div class="info-item">
                            <label>Teléfono:</label>
                            <span id="orderDetailsPhone"></span>
                        </div>
                        <div class="info-item">
                            <label>Fecha:</label>
                            <span id="orderDetailsDate"></span>
                        </div>
                        <div class="info-item">
                            <label>Estado:</label>
                            <span id="orderDetailsStatus"></span>
                        </div>
                        <div class="info-item">
                            <label>Estado de Pago:</label>
                            <span id="orderDetailsPaymentStatus"></span>
                        </div>
                        <div class="info-item">
                            <label>Método de Pago:</label>
                            <span id="orderDetailsPaymentMethod"></span>
                        </div>
                    </div>
                </div>
                
                <div class="order-info-section">
                    <h4>Dirección de Envío</h4>
                    <p id="orderDetailsAddress"></p>
                </div>
                
                <div class="order-info-section">
                    <h4>Items del Pedido</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>SKU</th>
                                <th>Precio</th>
                                <th>Cantidad</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody id="orderDetailsItems">
                        </tbody>
                    </table>
                </div>
                
                <div class="order-info-section">
                    <h4>Resumen</h4>
                    <div class="info-grid">
                        <div class="info-item">
                            <label>Subtotal:</label>
                            <span id="orderDetailsSubtotal"></span>
                        </div>
                        <div class="info-item">
                            <label>Envío:</label>
                            <span id="orderDetailsShipping"></span>
                        </div>
                        <div class="info-item">
                            <label>Impuestos:</label>
                            <span id="orderDetailsTax"></span>
                        </div>
                        <div class="info-item">
                            <label><strong>Total:</strong></label>
                            <span id="orderDetailsTotal"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODALS -->
    <!-- Product Modal -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2 id="productModalTitle">Crear Producto</h2>
            <form id="productForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Nombre *</label>
                        <input type="text" id="productName" required>
                    </div>
                    <div class="form-group">
                        <label>Slug *</label>
                        <input type="text" id="productSlug" required>
                    </div>
                    <div class="form-group">
                        <label>Precio *</label>
                        <input type="number" step="0.01" id="productPrice" required>
                    </div>
                    <div class="form-group">
                        <label>Precio Descuento</label>
                        <input type="number" step="0.01" id="productDiscountPrice">
                    </div>
                    <div class="form-group">
                        <label>Stock *</label>
                        <input type="number" id="productStock" required>
                    </div>
                    <div class="form-group">
                        <label>Categoría *</label>
                        <select id="productCategory" required>
                            <option value="">Seleccionar...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Marca</label>
                        <input type="text" id="productBrand">
                    </div>
                    <div class="form-group">
                        <label>SKU</label>
                        <input type="text" id="productSKU">
                    </div>
                    <div class="form-group">
                        <label>Subir Imagen</label>
                        <input type="file" id="productImageFile" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label>URL Imagen (alternativa)</label>
                        <input type="url" id="productImage" placeholder="https://...">
                    </div>
                    <div id="imagePreview" style="display: none; margin-top: 10px;">
                        <img id="previewImage" src="" alt="Preview" style="max-width: 200px; border-radius: 8px;">
                    </div>
                    <div class="form-group">
                        <label>Peso (kg)</label>
                        <input type="number" step="0.01" id="productWeight">
                    </div>
                    <div class="form-group">
                        <label>Dimensiones (cm)</label>
                        <input type="text" id="productDimensions" placeholder="L x A x A">
                    </div>
                    <div class="form-group">
                        <label>Activo</label>
                        <input type="checkbox" id="productIsActive" checked>
                    </div>
                </div>
                <div class="form-group">
                    <label>Descripción</label>
                    <textarea id="productDescription" rows="4"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.adminCRUD?.closeModalById('productModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Category Modal -->
    <div class="modal" id="categoryModal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2 id="categoryModalTitle">Crear Categoría</h2>
            <form id="categoryForm">
                <div class="form-group">
                    <label>Nombre *</label>
                    <input type="text" id="categoryName" required>
                </div>
                <div class="form-group">
                    <label>Slug *</label>
                    <input type="text" id="categorySlug" required>
                </div>
                <div class="form-group">
                    <label>URL Imagen</label>
                    <input type="url" id="categoryImage">
                </div>
                <div class="form-group">
                    <label>Descripción</label>
                    <textarea id="categoryDescription" rows="4"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.adminCRUD?.closeModalById('categoryModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Modal -->
    <div class="modal" id="userModal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2 id="userModalTitle">Editar Usuario</h2>
            <form id="userForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>Nombre *</label>
                        <input type="text" id="userFirstName" required>
                    </div>
                    <div class="form-group">
                        <label>Apellido *</label>
                        <input type="text" id="userLastName" required>
                    </div>
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" id="userEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Teléfono</label>
                        <input type="tel" id="userPhone">
                    </div>
                    <div class="form-group">
                        <label>Rol *</label>
                        <select id="userRole" required>
                            <option value="client">Cliente</option>
                            <option value="moderator">Moderador</option>
                            <option value="admin">Administrador</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Email Verificado</label>
                        <input type="checkbox" id="userEmailVerified">
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.adminCRUD?.closeModalById('userModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Review Modal -->
    <div class="modal" id="reviewModal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2 id="reviewModalTitle">Editar Reseña</h2>
            <form id="reviewForm">
                <div class="form-group">
                    <label>Rating *</label>
                    <select id="reviewRating" required>
                        <option value="1">1 Estrella</option>
                        <option value="2">2 Estrellas</option>
                        <option value="3">3 Estrellas</option>
                        <option value="4">4 Estrellas</option>
                        <option value="5">5 Estrellas</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Título</label>
                    <input type="text" id="reviewTitle">
                </div>
                <div class="form-group">
                    <label>Comentario</label>
                    <textarea id="reviewComment" rows="4"></textarea>
                </div>
                <div class="form-group">
                    <label>Aprobado</label>
                    <input type="checkbox" id="reviewIsApproved">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.adminCRUD?.closeModalById('reviewModal')">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chart.js for Dashboard Graphics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <!-- Admin Home Content Management -->
    <script src="js/admin-home-content.js"></script>
    
    <script src="js/api.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/admin-crud.js"></script>
    
    <script>
        // Funciones para preview de imagen
        function previewProductImage(input) {
            const file = input.files[0];
            if (file) {
                // Validar tipo de archivo
                if (!file.type.startsWith('image/')) {
                    window.notifications.error('Por favor selecciona un archivo de imagen');
                    input.value = '';
                    return;
                }

                // Validar tamaño (máx 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    window.notifications.error('La imagen no puede ser mayor a 5MB');
                    input.value = '';
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(event) {
                    document.getElementById('previewImage').src = event.target.result;
                    document.getElementById('imagePreviewContainer').style.display = 'block';
                    document.getElementById('imageFileName').textContent = file.name;
                    // Limpiar URL de imagen si había una
                    document.getElementById('productImage').value = '';
                };
                reader.readAsDataURL(file);
            }
        }

        function clearImagePreview() {
            document.getElementById('imagePreviewContainer').style.display = 'none';
            document.getElementById('previewImage').src = '';
            document.getElementById('imageFileName').textContent = '';
            document.getElementById('productImageFile').value = '';
        }

        // Hacer funciones globales
        window.previewProductImage = previewProductImage;
        window.clearImagePreview = clearImagePreview;
    </script>

    <!-- Hero Slide Modal -->
    <div id="heroSlideModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="heroSlideModalTitle">Crear Hero Slide</h3>
                <span class="modal-close" onclick="window.closeHeroSlideModal()">&times;</span>
            </div>
            <form id="heroSlideForm">
                <div class="form-group">
                    <label>Título *</label>
                    <input type="text" id="heroSlideTitle" required>
                </div>
                <div class="form-group">
                    <label>Descripción</label>
                    <textarea id="heroSlideDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Texto del Botón</label>
                    <input type="text" id="heroSlideButtonText">
                </div>
                <div class="form-group">
                    <label>Link del Botón</label>
                    <input type="text" id="heroSlideButtonLink">
                </div>
                <div class="form-group">
                    <label>URL de Imagen</label>
                    <input type="text" id="heroSlideImageUrl">
                    <input type="file" id="heroSlideImageFile" accept="image/*" onchange="previewHeroSlideImage(this)">
                    <div id="heroSlidePreviewContainer" style="margin-top: 10px; display: none;">
                        <img id="heroSlidePreview" src="" alt="Preview" style="max-width: 200px; border-radius: 4px;">
                    </div>
                </div>
                <div class="form-group">
                    <label>Color de Fondo (hex)</label>
                    <input type="color" id="heroSlideBackgroundColor" value="#667eea">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Orden</label>
                        <input type="number" id="heroSlideOrder" value="0">
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="heroSlideIsActive" checked> Activo
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.closeHeroSlideModal()">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Banner Modal -->
    <div id="bannerModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="bannerModalTitle">Crear Banner</h3>
                <span class="modal-close" onclick="window.closeBannerModal()">&times;</span>
            </div>
            <form id="bannerForm">
                <div class="form-group">
                    <label>Título *</label>
                    <input type="text" id="bannerTitle" required>
                </div>
                <div class="form-group">
                    <label>Descripción</label>
                    <textarea id="bannerDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Texto del Botón</label>
                    <input type="text" id="bannerButtonText">
                </div>
                <div class="form-group">
                    <label>Link del Botón</label>
                    <input type="text" id="bannerButtonLink">
                </div>
                <div class="form-group">
                    <label>URL de Imagen</label>
                    <input type="text" id="bannerImageUrl">
                    <input type="file" id="bannerImageFile" accept="image/*" onchange="previewBannerImage(this)">
                    <div id="bannerPreviewContainer" style="margin-top: 10px; display: none;">
                        <img id="bannerPreview" src="" alt="Preview" style="max-width: 200px; border-radius: 4px;">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Tipo de Banner *</label>
                        <select id="bannerType" required>
                            <option value="promo">Promoción</option>
                            <option value="affiliate">Afiliado</option>
                            <option value="grid">Grid</option>
                            <option value="flash">Flash</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Posición</label>
                        <select id="bannerPosition">
                            <option value="hero">Hero</option>
                            <option value="benefits">Benefits</option>
                            <option value="middle">Middle</option>
                            <option value="bottom">Bottom</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Fecha Inicio</label>
                        <input type="date" id="bannerStartDate">
                    </div>
                    <div class="form-group">
                        <label>Fecha Fin</label>
                        <input type="date" id="bannerEndDate">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Orden</label>
                        <input type="number" id="bannerOrder" value="0">
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="bannerIsActive" checked> Activo
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.closeBannerModal()">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Benefit Modal -->
    <div id="benefitModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="benefitModalTitle">Crear Beneficio</h3>
                <span class="modal-close" onclick="window.closeBenefitModal()">&times;</span>
            </div>
            <form id="benefitForm">
                <div class="form-group">
                    <label>Título *</label>
                    <input type="text" id="benefitTitle" required>
                </div>
                <div class="form-group">
                    <label>Descripción</label>
                    <textarea id="benefitDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Icono (Font Awesome class)</label>
                    <input type="text" id="benefitIcon" placeholder="fas fa-gift">
                </div>
                <div class="form-group">
                    <label>URL de Imagen</label>
                    <input type="text" id="benefitImageUrl">
                    <input type="file" id="benefitImageFile" accept="image/*" onchange="previewBenefitImage(this)">
                    <div id="benefitPreviewContainer" style="margin-top: 10px; display: none;">
                        <img id="benefitPreview" src="" alt="Preview" style="max-width: 200px; border-radius: 4px;">
                    </div>
                </div>
                <div class="form-group">
                    <label>Color de Fondo (hex)</label>
                    <input type="color" id="benefitBackgroundColor" value="#667eea">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Orden</label>
                        <input type="number" id="benefitOrder" value="0">
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="benefitIsActive" checked> Activo
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.closeBenefitModal()">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Home Section Modal -->
    <div id="homeSectionModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="homeSectionModalTitle">Crear Sección del Home</h3>
                <span class="modal-close" onclick="window.closeHomeSectionModal()">&times;</span>
            </div>
            <form id="homeSectionForm">
                <div class="form-group">
                    <label>Tipo de Sección *</label>
                    <select id="homeSectionType" required>
                        <option value="category_carousel">Carrusel de Categoría</option>
                        <option value="categories_grid">Grid de Categorías</option>
                        <option value="featured_products">Productos Destacados</option>
                        <option value="flash_offers">Ofertas Flash</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Título</label>
                    <input type="text" id="homeSectionTitle">
                </div>
                <div class="form-group">
                    <label>Categoría (para carruseles)</label>
                    <select id="homeSectionCategory">
                        <option value="">Seleccionar...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Límite de Productos</label>
                    <input type="number" id="homeSectionLimit" value="8">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Orden</label>
                        <input type="number" id="homeSectionOrder" value="0">
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="homeSectionIsActive" checked> Activo
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.closeHomeSectionModal()">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>
</body>
</html>


